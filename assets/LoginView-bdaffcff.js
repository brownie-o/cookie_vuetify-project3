import{_ as B,u as A,c as C,a as F,l as q,b as M,r as b,o as N,e as P,i as o,w as p,h as a,J as U,s as $,K as E,L as _,V as T,I as j,p as z,n as D,q as w}from"./index-70f49df9.js";import{c as J,a as g,u as K,b as x}from"./index.esm-b55ccfe2.js";import{V as R}from"./VForm-d29a6ccc.js";import"./_commonjsHelpers-de833af9.js";const V=n=>(z("data-v-86ef0c03"),n=n(),D(),n),G=V(()=>w("div",{class:"text-subtitle-1 text-medium-emphasis"},"Account",-1)),H=V(()=>w("div",{class:"text-subtitle-1 text-medium-emphasis d-flex align-center justify-space-between"},"Password",-1)),O={__name:"LoginView",setup(n){const{xs:l}=A();C(()=>l.value);const{api:h}=$(),m=F(),v=q(),i=M(),r=b(!1);b(!1);const y=J({account:g().required("帳號為必填欄位").min(6,"帳號長度不符").max(20,"使用者帳號長度不符"),password:g().required("密碼為必填欄位").min(6,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:S,isSubmitting:k}=K({validationSchema:y}),c=x("account"),u=x("password"),f=()=>{if(l.value)return"center";if(!l.value)return"bottom"},I=S(async d=>{var e,s;try{const{data:t}=await h.post("/users/login",{account:d.account,password:d.password});if(i.login(t.result),v({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:f(),rounded:"pill",variant:"tonal"}}),i.isAdmin){if(i.isAdmin)return m.push("/admin")}else return m.push("/profile")}catch(t){console.log(t);const L=((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||"發生錯誤，請稍後再試";v({text:L,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:f(),rounded:"pill",variant:"tonal"}})}});return(d,e)=>(N(),P("div",null,[o(R,{class:"mt-50",disabled:a(k),onSubmit:U(a(I),["prevent"])},{default:p(()=>[o(E,{class:"mx-auto pa-12 pb-8",elevation:"8","max-width":"448",title:"Login",rounded:"lg"},{default:p(()=>[G,o(_,{density:"compact",placeholder:"Account","prepend-inner-icon":"mdi-account-circle",modelValue:a(c).value.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a(c).value.value=s),"error-messages":a(c).errorMessage.value,variant:"outlined",maxlength:"20",counter:"20",clearable:""},null,8,["modelValue","error-messages"]),H,o(_,{"append-inner-icon":r.value?"mdi-eye-off":"mdi-eye",type:r.value?"text":"password",density:"compact",placeholder:"Enter your password","prepend-inner-icon":"mdi-lock-outline",modelValue:a(u).value.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a(u).value.value=s),"error-messages":a(u).errorMessage.value,variant:"outlined",maxlength:"20",counter:"20",clearable:"","onClick:appendInner":e[2]||(e[2]=s=>r.value=!r.value)},null,8,["append-inner-icon","type","modelValue","error-messages"]),o(T,{class:"mb-8",block:"",color:"blue",size:"large",variant:"tonal",type:"submit"},{default:p(()=>[j("Log In")]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]))}},Z=B(O,[["__scopeId","data-v-86ef0c03"]]);export{Z as default};
